'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = waitForEvent;

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function waitForEvent(options) {
  return new _bluebird2.default(function (resolve, reject) {
    var timeoutHandle = void 0;
    var onEvent = function onEvent(result) {
      if (timeoutHandle) {
        clearTimeout(timeoutHandle);
      }
      resolve(result);
    };

    if (options.timeout) {
      timeoutHandle = setTimeout(function () {
        if (options.target.off) {
          options.target.off(options.event, onEvent);
        }
        reject(new Error('timeout'));
      }, options.timeout);
    }

    options.target.once(options.event, onEvent);
    if (options.trigger) {
      options.trigger();
    }
  });
}
//# sourceMappingURL=waitForEvent.js.map
