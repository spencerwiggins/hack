'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = selectTopOutliers;

var _simpleStatistics = require('simple-statistics');

var _simpleStatistics2 = _interopRequireDefault(_simpleStatistics);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function selectTopOutliers(inputResults) {

  var sortedScores = _lodash2.default.reverse(inputResults.map(function (result) {
    return result.score;
  }));

  var q25 = _simpleStatistics2.default.quantileSorted(sortedScores, 0.25);
  var q75 = _simpleStatistics2.default.quantileSorted(sortedScores, 0.75);
  var iqr = q75 - q25;
  var maxScore = sortedScores[sortedScores.length - 1];

  var topResults = void 0;

  if (maxScore > 1.5 * iqr + q75) {
    // get the outliers, anything above 1.5(iqr)+q75
    topResults = inputResults.filter(function (result) {
      return result.score > 1.5 * iqr + q75;
    });
  } else {
    // get the larger of the first 5 items or the top quartile
    var idx = Math.ceil(inputResults.length * 0.25);
    topResults = inputResults.slice(0, Math.max(idx, 5));
  }

  return topResults;
}
//# sourceMappingURL=selectTopOutliers.js.map
