{"version":3,"sources":["helpers/waitForEvent.js"],"names":["waitForEvent","options","resolve","reject","timeoutHandle","onEvent","result","clearTimeout","timeout","setTimeout","target","off","event","Error","once","trigger"],"mappings":";;;;;kBAGwBA,Y;;AAFxB;;;;;;AAEe,SAASA,YAAT,CAAyBC,OAAzB,EAAwH;AACrI,SAAO,uBAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAIC,sBAAJ;AACA,QAAMC,UAAU,SAAVA,OAAU,CAACC,MAAD,EAAe;AAC7B,UAAIF,aAAJ,EAAmB;AACjBG,qBAAaH,aAAb;AACD;AACDF,cAAQI,MAAR;AACD,KALD;;AAOA,QAAIL,QAAQO,OAAZ,EAAqB;AACnBJ,sBAAgBK,WAAW,YAAM;AAC/B,YAAIR,QAAQS,MAAR,CAAeC,GAAnB,EAAwB;AACtBV,kBAAQS,MAAR,CAAeC,GAAf,CAAmBV,QAAQW,KAA3B,EAAkCP,OAAlC;AACD;AACDF,eAAO,IAAIU,KAAJ,CAAU,SAAV,CAAP;AACD,OALe,EAKbZ,QAAQO,OALK,CAAhB;AAMD;;AAEDP,YAAQS,MAAR,CAAeI,IAAf,CAAoBb,QAAQW,KAA5B,EAAmCP,OAAnC;AACA,QAAIJ,QAAQc,OAAZ,EAAqB;AACnBd,cAAQc,OAAR;AACD;AACF,GAtBM,CAAP;AAuBD","file":"helpers/waitForEvent.js","sourcesContent":["//@flow\nimport Promise from 'bluebird';\n\nexport default function waitForEvent<T>(options: { event: string, target: Object, timeout?: ?number, trigger?: Function }): Promise<T> {\n  return new Promise((resolve, reject) => {\n    let timeoutHandle;\n    const onEvent = (result: T) => {\n      if (timeoutHandle) {\n        clearTimeout(timeoutHandle);\n      }\n      resolve(result);\n    };\n\n    if (options.timeout) {\n      timeoutHandle = setTimeout(() => {\n        if (options.target.off) {\n          options.target.off(options.event, onEvent);\n        }\n        reject(new Error('timeout'));\n      }, options.timeout);\n    }\n\n    options.target.once(options.event, onEvent);\n    if (options.trigger) {\n      options.trigger();\n    }\n  });\n}\n"],"sourceRoot":"/source/"}