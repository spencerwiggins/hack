//@flow
import path from 'path';
import boot from 'loopback-boot';

export default  function bootApp(app:LoopbackApp): Promise<LoopbackApp> {
  return new Promise((resolve, reject) => {
    app.on('booted', () => resolve(app));

    // if not already booting (flag is set by loopback-boot), boot it now
    if (!app.booting) {
      const bootOptions = {
        appRootDir: path.join(__dirname, '../src/server'),
        bootDirs: [
          'eil-platform-remotes/lib/server/boot',
        ],
      };

      boot(app, bootOptions, (err) => err && reject(err));
    }
  });
}
